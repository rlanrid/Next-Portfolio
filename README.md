# ğŸ˜Next.jsë¡œ Threadë§Œë“¤ê¸°
ìœ íŠœë¸Œ ê°•ì˜ë¥¼ í†µí•´ì„œ Next.jsë¥¼ ì‚¬ìš©í•´ Thread ì‚¬ì´íŠ¸ë¥¼ ë§Œë“¤ì—ˆìŠµë‹ˆë‹¤.
[ì°¸ê³ ì˜ìƒ](https://www.youtube.com/watch?v=O5cmLDVTgAs)

## ğŸ”§ì´ˆê¸°ì„¸íŒ…
`npx create-next-app@latest .`   
`npm i`   

`npm install @clerk/themes`   
`npx shadcn-ui@latest add form`   
`npx shadcn-ui@latest init`   

## ğŸ§¾ê°œë… ì •ë¦¬
- TypeScript   
TypeScriptëŠ” ë§ˆì´í¬ë¡œì†Œí”„íŠ¸ì—ì„œ ê°œë°œí•œ ì˜¤í”ˆ ì†ŒìŠ¤ í”„ë¡œê·¸ë˜ë° ì–¸ì–´ë¡œ, JavaScriptì˜ í™•ì¥ì´ì ìƒìœ„ ì§‘í•© ì–¸ì–´ì´ë©°,      
ì •ì  íƒ€ì… ì‹œìŠ¤í…œì„ ë„ì…í•˜ì—¬ ê°œë°œìì—ê²Œ ì½”ë“œì˜ ì•ˆì •ì„±ê³¼ ê°€ë…ì„±ì„ í–¥ìƒì‹œí‚¬ ìˆ˜ ìˆëŠ” ê¸°ëŠ¥ì„ ì œê³µí•©ë‹ˆë‹¤.

- Shadcn   
Shadcn/uiëŠ” ì¬ì‚¬ìš© UI ì»´í¬ë„ŒíŠ¸ ëª¨ìŒì…ë‹ˆë‹¤. ì´ê²ƒì„ ì‚¬ìš©í•´ ì»´í¬ë„ŒíŠ¸ë¥¼ 
ì†ì‰½ê²Œ ì‚¬ìš©í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

- Uploadthing   
Uploadthingì€ íƒ€ì…ìŠ¤í¬ë¦½íŠ¸ ì•±ì—ì„œ ê°€ì¥ ì‰¬ìš´ íŒŒì¼ ì—…ë¡œë“œ ë°©ë²•ì…ë‹ˆë‹¤.   
ì´ë¥¼ ì‚¬ìš©í•´ íŒŒì¼ì„ ì†ì‰½ê²Œ ì—…ë¡œë“œ í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. 

- Tailwind CSS   
Tailwind CSSëŠ” ìœ ì—°í•˜ê³  í™•ì¥ ê°€ëŠ¥í•œ CSS í”„ë ˆì„ì›Œí¬ì…ë‹ˆë‹¤. ì¼ë°˜ì ì¸ CSS í”„ë ˆì„ì›Œí¬ì™€ëŠ” ë‹¬ë¦¬   
ì‚¬ì „ ì •ì˜ëœ í´ë˜ìŠ¤ë¥¼ ì‚¬ìš©í•˜ì—¬ ìŠ¤íƒ€ì¼ì„ ì ìš©í•˜ëŠ” ë°©ì‹ìœ¼ë¡œ ì‘ë™í•©ë‹ˆë‹¤.   
ì´ í´ë˜ìŠ¤ë“¤ì€ ì£¼ë¡œ HTML ìš”ì†Œì— ì§ì ‘ ì ìš©ë˜ì–´ ë””ìì¸ì„ êµ¬ì„±í•˜ëŠ” ë° ì‚¬ìš©ë©ë‹ˆë‹¤.

- Clerk   
ClerkëŠ” ê°œë°œìê°€ ì‚¬ìš©ì ê´€ë¦¬ì™€ ì¸ì¦ ê¸°ëŠ¥ì„ ì‰½ê²Œ êµ¬ì¶•í•  ìˆ˜ ìˆë„ë¡ ë„ì™€ì£¼ëŠ” í”Œë«í¼ ì¤‘ í•˜ë‚˜ì…ë‹ˆë‹¤.   
ì‚¬ìš©ì ê´€ë¦¬, ì¸ì¦, ê¶Œí•œ ë¶€ì—¬, í”„ë¡œí•„ ê´€ë¦¬ ë“±ì„ ê°„í¸í•˜ê²Œ ì²˜ë¦¬í•  ìˆ˜ ìˆëŠ” ë„êµ¬ë¡œ,   
ê°œë°œìë“¤ì´ ë³´ë‹¤ ë¹ ë¥´ê³  ì•ˆì „í•˜ê²Œ ì‚¬ìš©ì ê´€ë¦¬ ê¸°ëŠ¥ì„ êµ¬í˜„í•˜ëŠ” ë° ë„ì›€ì„ ì¤ë‹ˆë‹¤.

- Zod   
ZodëŠ” TypeScriptì—ì„œ ì‚¬ìš©í•  ìˆ˜ ìˆëŠ” ë°ì´í„° ê²€ì¦ ë° ìŠ¤í‚¤ë§ˆ ì •ì˜ ë¼ì´ë¸ŒëŸ¬ë¦¬ì…ë‹ˆë‹¤.   
ì£¼ë¡œ ê°œë°œìê°€ ë°ì´í„°ì˜ ìœ íš¨ì„±ì„ ê²€ì‚¬í•˜ê³  ë°ì´í„°ì˜ í˜•ì‹ì„ ì •ì˜í•˜ëŠ” ë° ì‚¬ìš©ë©ë‹ˆë‹¤.   
ZodëŠ” íƒ€ì… ì•ˆì „ì„±ì„ ì œê³µí•˜ë©´ì„œ ëŸ°íƒ€ì„ì—ì„œë„ ì‚¬ìš©í•  ìˆ˜ ìˆëŠ” ê²€ì¦ì„ ìˆ˜í–‰í•˜ëŠ” ê°•ë ¥í•œ ë„êµ¬ì…ë‹ˆë‹¤.   

## ğŸ”ì£¼ìš” ê¸°ëŠ¥
[íšŒì›ê°€ì… & ë¡œê·¸ì¸]   

íšŒì›ê°€ì…ê³¼ ë¡œê·¸ì¸ ê¸°ëŠ¥ì€ [clerk](https://clerk.com/)ë¥¼ ì´ìš©í•´ ì‘ì—…í–ˆìŠµë‹ˆë‹¤.  
<br/> 
<img src='public/assets/img/login1.png' />   
<br/>
appí´ë” ì•ˆì— (auth) íŒŒì¼ì„ ë§Œë“  ë’¤, [[...sign-in]]ê³¼ [[...sign-up]]í´ë”ë¥¼ ë§Œë“­ë‹ˆë‹¤.
```js
import { SignIn } from "@clerk/nextjs";

export default function Page() {
    return <SignIn />
}
```
ê° í´ë”ì—ëŠ” clerkì—ì„œ ì œê³µí•˜ëŠ” ëª¨ë“ˆë§Œ importí•˜ë©´ íšŒì›ê°€ì…/ë¡œê·¸ì¸ì´ ì™„ì„±ë©ë‹ˆë‹¤.   
<br/>
<br/>

[í”„ë¡œí•„ ì„¤ì •]   
íšŒì›ê°€ì…ê³¼ ë¡œê·¸ì¸ì´ ì„±ê³µí•˜ê³ , í•œ ë²ˆë„ í”„ë¡œí•„ ì„¤ì •ì„ í•˜ì§€ ì•Šì•˜ë‹¤ë©´   
/onboarding í˜ì´ì§€ë¡œ ì´ë™í•´ ì‚¬ì§„ê³¼ ì´ë¦„ ë“±ì„ ì‘ì„±í•©ë‹ˆë‹¤.   
ë§Œì•½ ì´ë¯¸ í”„ë¡œí•„ì„ ì„¤ì •í•œ ì ì´ ìˆë‹¤ë©´ ë©”ì¸í˜ì´ì§€ë¡œ ì´ë™í•©ë‹ˆë‹¤.   
```js
import AccountProfile from "@/components/forms/AccountProfile"
import { fetchUser } from "@/lib/actions/user.actions";
import { currentUser } from "@clerk/nextjs"
import { redirect } from "next/navigation";

async function Page() {
    const user = await currentUser();
    if (!user) return null;

    const userInfo = await fetchUser(user.id);
    if (userInfo?.onboarded) redirect("/");

    const userData = {
        id: user?.id,
        objectId: userInfo?._id,
        username: userInfo ? userInfo?.username : user?.username,
        name: userInfo ? userInfo?.name : user.firstName || "",
        bio: userInfo ? userInfo?.bio : "",
        image: userInfo ? userInfo?.image : user?.imageUrl,
    }

    return (
        <main className="mx-auto flex max-w-3xl flex-col 
        justify-start px-10 py-20">
            <h1 className="head-text">Onboarding</h1>
            <p className="mt-3 text-base-regular text-light-2">
                Complete your profile now to use Threads
            </p>

            <section className="mt-9 bg-dark-2 p-10">
                <AccountProfile user={userData} btnTitle="Continue" />
            </section>
        </main>
    )
}

export default Page
```   
<br/>
<br/>

[ìŠ¤ë ˆë“œ ì‘ì„±]   
clerkì—ì„œ í˜„ì¬ ìœ ì € ì •ë³´ë¥¼ ê°€ì ¸ì˜¨ ë’¤, ê·¸ ê°’ì„ PostThread ì»´í¬ë„ŒíŠ¸ì—   
ì „ë‹¬í•©ë‹ˆë‹¤. ì´ ë•Œ ìœ ì € ì •ë³´ê°€ ì—†ë‹¤ë©´ nullì„ ë°˜í™˜í•˜ê³  ë¡œê·¸ì¸ í˜ì´ì§€ë¡œ   
ì´ë™í•©ë‹ˆë‹¤.   
```js
import PostThread from '@/components/forms/PostThread';
import { fetchUser } from '@/lib/actions/user.actions';
import { currentUser } from '@clerk/nextjs';
import { redirect } from 'next/navigation';

async function Page() {
    const user = await currentUser();

    if (!user) return null;

    const userInfo = await fetchUser(user.id);

    if (!userInfo?.onboarded) redirect('/onboarding');

    return (
        <>
            <h1 className="head-text">Create Thread</h1>
            <PostThread userId={userInfo._id} />
        </>
    )
}

export default Page;
```

PostThreadì˜ ë””ìì¸ì€ shadcnì˜ ì»´í¬ë„ŒíŠ¸ë¥¼ ë¶ˆëŸ¬ì™€ì„œ ì‚¬ìš©í–ˆìŠµë‹ˆë‹¤.   
<br/>
<br/>

[ë¦¬í”Œ ì‘ì„±]   
ìƒìœ„ ì»´í¬ë„ŒíŠ¸ì—ì„œ ë°›ì•„ì˜¨ Props ë°ì´í„°ë¥¼ Comment ì»´í¬ë„ŒíŠ¸ì—ì„œ ì„¤ì •í•©ë‹ˆë‹¤.   
```js
interface Props {
    threadId: string;
    currentUserImg: string;
    currentUserId: string;
}

const Comment = ({ threadId, currentUserImg, currentUserId }: Props) => { ...ë‚˜ë¨¸ì§€ ì½”ë“œ }
```   

useForm í•¨ìˆ˜ë¥¼ í˜¸ì¶œí•˜ê³  ì´ì „ì— ë§Œë“¤ì–´ ë‘” Zod ìŠ¤í‚¤ë§ˆë¥¼ ì‚¬ìš©í•´ ê²€ì¦ì„ ìˆ˜í–‰í•©ë‹ˆë‹¤.    
ëŒ“ê¸€ ì‘ì„±ì€ onSubmit ì½œë°± í•¨ìˆ˜ë¥¼ ë§Œë“¤ì–´ ëŒ“ê¸€ ì •ë³´ë¥¼ í•´ë‹¹ ìŠ¤ë ˆë“œì— ì¶”ê°€í•˜ê³ ,
ì™„ë£Œë˜ë©´ formí•„ë“œë¥¼ ë¹„ì›ë‹ˆë‹¤.   
```js
const form = useForm({
        resolver: zodResolver(CommentValidation),
        defaultValues: {
            thread: '',
        }
    });

    const onSubmit = async (values: z.infer<typeof CommentValidation>) => {
        await addCommentToThread(threadId, values.thread, JSON.parse
            (currentUserId), pathname);

        window.alert('ë¦¬í”Œì´ ì‘ì„±ë˜ì—ˆìŠµë‹ˆë‹¤.');
        form.reset();
    }
```   
<br/>
<br/>

[ì»¤ë®¤ë‹ˆí‹° ê¸°ëŠ¥]   
ì»¤ë®¤ë‹ˆí‹° ê¸°ëŠ¥ ì—­ì‹œ clerkì— ìˆëŠ” `OrganizationSwitcher` ëª¨ë“ˆì„ ì‚¬ìš©í•´ ë§Œë“¤ì—ˆìŠµë‹ˆë‹¤.   
```js
<OrganizationSwitcher
    appearance={{
        baseTheme: dark,
        elements: {
            OrganizationSwitcher:
                "py-2 px-4"
        }
    }}
/>
```   

## ğŸ˜‹íŠ¸ëŸ¬ë¸”ìŠˆíŒ…
<details>
    <summary>
    Unhandled Runtime Error   
    Error: ClerkInstanceContext not found
    </summary>

    - ë¬¸ì œ ì›ì¸   
    
    <html lang="en">
        <body className={inter.className}>
            {children}  
        </body>
    </html>   
    ClerkProvider íƒœê·¸ë¡œ ê°ì‹¸ì•¼ì§€ ì‚¬ìš©ì´ ê°€ëŠ¥í•œë°, ì•„ë¬´ê²ƒë„ ê°ì‹¸ì§€ ì•Šì•„ì„œ ì˜¤ë¥˜ë°œìƒ
    
    - ë¬¸ì œ í•´ê²°

    <html lang="en">
        <ClerkProvider>
            <body className={inter.className}>
                {children}  
            </body>
        </ClerkProvider>
    </html>
    ë¬¸ì„œë¥¼ ì°¸ì¡°í•´ íƒœê·¸ë¡œ ê°ì‹¸ë©´ í•´ê²°
</details>
<br />
<details>
    <summary>
    ì¡°ê±´ë¬¸ ë¯¸í™œìš© ì‹œ ë¦¬ë‹¤ì´ë ‰íŠ¸ ì´ìŠˆ
    </summary>

    - ë¬¸ì œ ì›ì¸   
    
    `userInfo?.onboarded`ì˜ ê°’ì´ `false`ì¸ ê²½ìš°, `redirect('/onboarding')`ë¡œ ë¦¬ë‹¤ì´ë ‰íŠ¸ í•˜ëŠ”ë°, í•¨ìˆ˜ê°€ ë°˜í™˜í•˜ëŠ” ê°’ì´ nullì´ê±°ë‚˜ `undefined`ì¸ ê²½ìš° ì¡°ê±´ë¬¸ì´ ì‘ë™ í•˜ì§€ ì•Šì„ ìˆ˜ ìˆë‹¤.   
    
    - ë¬¸ì œ í•´ê²°

    ```js
    const userInfo = await fetchUser(user.id);
    if (!userInfo || !userInfo.onboarded) {
        redirect('/onboarding');
        return null; // ë¦¬ë‹¤ì´ë ‰íŠ¸ ì´í›„ ì¶”ê°€ ì½”ë“œ ì‹¤í–‰ ë°©ì§€
    }
    ```
    ë¦¬ë‹¤ì´ë ‰íŠ¸ë¥¼ ìˆ˜í–‰í•˜ê¸° ì „ì— `userInfo`ê°’ì´ ìœ íš¨í•œì§€ í™•ì¸í•˜ë©´ ëœë‹¤.
</details>

## ğŸ“ì‚¬ì´íŠ¸

ì¸ì¦ ì„œë¹„ìŠ¤ - [clerk](https://clerk.com/)   
íŒŒì¼ ì—…ë¡œë“œ - [uploadthing](https://uploadthing.com/)   
ë°°í¬ - [vercel](https://vercel.com/)   


## ğŸ“˜ìŠ¤íƒ
<div>
  <a href="#"><img alt="next.js" src="https://img.shields.io/badge/next.js-000000?style=flat&logo=next.js&logoColor=white"></a>
  <a href="#"><img alt="Tailwind CSS" src="https://img.shields.io/badge/Tailwind CSS-06B6D4?logo=Tailwind CSS&logoColor=white"></a>
  <a href="#"><img alt="TypeScript" src="https://img.shields.io/badge/TypeScript-3178C6?logo=TypeScript&logoColor=white"></a>
  <a href="#"><img alt="MongoDB" src="https://img.shields.io/badge/MongoDB-47A248?logo=MongoDB&logoColor=white"></a>
  <a href="#"><img alt="Clerk" src="https://img.shields.io/badge/  Clerk-6C47FF?logo=Clerk&logoColor=white"></a>
</div>
